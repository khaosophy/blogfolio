---
import Header from '../../../components/Header.astro';
import Footer from '../../../components/Footer.astro';
import PageMeta from '../../../components/PageMeta.astro';
import Excerpt from '../../../components/Excerpt.astro';
import Pagination from '../../../components/Pagination.astro';

export async function getStaticPaths({ paginate }) {
  const response = await fetch('https://wp.khaosophy.com/wp-json/wp/v2/posts?per_page=100');
  const posts = await response.json();

  return paginate(posts, { pageSize: 5 });
}
const { page } = Astro.props;
console.log(page.total);
---

<html lang="en">
<head>
	<PageMeta
		title="All posts"
		description="Casey is a front end developer with a background in SEO and business management."
	/>
</head>
<body>
	<Header />
	<main>
		{page.data.map(post => (
			<Excerpt
				id={post.id}
				date={post.date}
				slug={post.slug}
				title={post.title.rendered}
				summary={post.excerpt.rendered}
			/>
		))}
    <Pagination
      nextPageUrl={page.url.next}
      prevPageUrl={page.url.prev}
    />
	</main>
	<Footer />
</body>
</html>